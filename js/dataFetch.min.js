import{urlParam}from"./nav.min.js";export const datafetch=()=>{function t(){$.getJSON("../data/b.json",function(t){$.getJSON("../data/d.json",function(s){e(t,s)}).fail(function(t){console.error("Error fetching distributor data:",t)})}).fail(function(t){console.error("Error fetching product data:",t)})}function e(t,e){const o=$("<div>").addClass("badge bg-danger rounded-circle p-2 m-2 position-fixed top-0 start-0 fs-5 shadow").text(t.length).css({zIndex:100});$(".data-num").append(o),$("#productList").empty(),t.forEach(t=>{const o=e.find(e=>e.gds===t.gds),a=s(t.gds,t.title,t.price,o.price,o.points,t.imageUrl);$("#productList").append(a)})}function s(t,e,s,o,a,n){const r=$("<div>").addClass("card col-10 col-lg-5 col-xxl-3 m-4 border-0 animated invisible").attr("data-link",t),d=$("<img>").addClass("mx-auto my-2").attr({"data-src":n,alt:`${e} | Atomy Keson`,loading:"lazy"}).css({width:"200px",height:"200px"}),c=$("<div>").addClass("card-body text-center p-2 mb-2 rounded-4 shadow"),i=$("<div>").addClass("rounded-4 mx-5 py-2 bg-dark mb-3"),l=$("<h5>").addClass("card-title fs-4 mb-2").text(e),u=$("<p>").addClass("card-text text-primary fw-bold fs-5 mb-3").text("MRP: ₹ "+s),g=$("<p>").addClass("card-text text-success fw-bolder fs-3 mb-0 pb-0").text("DP: ₹ "+o),p=$("<p>").addClass("card-text text-danger fw-bold fs-3").text("PV: "+a),f=$("<a>").attr("href",`/product/?gds=${t}`).addClass("btn btn-primary mb-4 rounded-3 product-link").text("Read Details");return i.append(g,p),c.append(l,u,i,f),r.append(d,c),observer.observe(d[0]),r}function o(){return $(window).width()<$(window).height()}function a(){console.log("Mobile screen detected!")}function n(){console.log("Non-mobile screen detected!"),setInterval(function(){$(".card").addClass("shadow"),$(".card-body").removeClass("shadow")},300)}function r(t,e){let s=null;return function(){clearTimeout(s),s=setTimeout(t,e)}}function d(){o()?a():n()}t(),d();const c=r(d,200);$(window).on("resize",c)};export const details=()=>{var t=urlParam("gds");t&&$.getJSON("../data/p.json",function(e){var s=e.find(function(e){return e.gds===t});s&&$.getJSON("../data/b.json",function(t){const e=t.find(function(t){return t.gds===s.gds});var o=$("<img>").attr({src:s.bannerImgUrl,alt:e.title}).addClass("mx-auto d-flex pb-5").css({width:"300px",height:"300px"});const a=$("<h1>").text(e.title).addClass("title text-center");if(s.detailImages&&s.detailImages.length>0){var n=$("#imageD1");s.detailImages.forEach(function(t){var e=$("<img>").attr({"data-src":t,alt:"detailed img",loading:"lazy"}).addClass("p-1").css({width:"100%"});n.append(e),observer.observe(e[0])})}else console.log("no images");var r=$("#result");r.append(o,a)})}).fail(function(t){console.log("Error fetching JSON data:",t)})};export const locStore=(t,e)=>{localStorage.setItem(t,JSON.stringify(e))};export const locGet=t=>{const e=localStorage.getItem(t);return e?JSON.parse(e):null};export const locRem=t=>{localStorage.removeItem(t)};export const locCls=()=>{localStorage.clear()};export const sessionStore=(t,e)=>{sessionStorage.setItem(t,e)};export const sessionGet=t=>sessionStorage.getItem(t)?sessionStorage.getItem(t):null;export const observer=new IntersectionObserver(t=>{const e="invisible";t.forEach(t=>{const s=$(t.target),o=s.closest(".card");t.isIntersecting?(s.attr("src",s.data("src")),o.length?o.addClass("fadeIn").removeClass(e):s.addClass("fadeIn").removeClass(e)):o.length})});export const searchbar=()=>{function t(t,e){return e.filter(e=>e.title.toLowerCase().includes(t.toLowerCase()))}function e(t){0===t.length||($("#productList .card").addClass("visually-hidden"),t.forEach(t=>{const e=$(`#productList .card:contains("${t.title}")`);e.removeClass("visually-hidden")}))}const s=$("#closeIcon");$.getJSON("../data/d.json",function(s){const o=s;$("#searchInput").on("input",function(){const s=$(this).val();if(""!==s.trim()){const a=t(s,o);e(a)}else $("#productList .card").removeClass("visually-hidden")})}),s.on("click",function(){$("#searchInput").val("").focus(),$("#productList .card").removeClass("visually-hidden")})};