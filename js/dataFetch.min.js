import{urlCrawler}from"./nav.min.js";export const datafetch=()=>{function t(){$.getJSON("data/level0.json",function(t){$.getJSON("data/level1.json",function(a){e(t,a)}).fail(function(t){console.error("Error fetching distributor data:",t)})}).fail(function(t){console.error("Error fetching product data:",t)})}function e(t,e){const s=$("<div>").addClass("badge bg-danger rounded-circle p-2 m-2 position-fixed top-0 start-0 fs-5 shadow").text(t.length).css({zIndex:100});$(".data-num").append(s),$("#productList").empty(),t.forEach(t=>{const s=e.find(e=>e.gds===t.gds),o=a(t.gds,t.title,t.price,s.price,s.points,t.imageUrl);$("#productList").append(o)})}function a(t,e,a,s,o,r){const n=$("<div>").addClass("card col-md-4 col-lg-2 m-4 border-0 animated slow").attr("data-link",t),d=$("<img>").addClass("mx-auto my-2").attr({"data-src":r,alt:t,loading:"lazy"}).css({width:"200px",height:"200px"}),c=$("<div>").addClass("card-body text-center p-2 mb-2 rounded-4 shadow"),i=$("<div>").addClass("rounded-4 mx-5 py-2 bg-dark mb-3"),l=$("<h5>").addClass("card-title fs-4 mb-2").text(e),u=$("<p>").addClass("card-text text-primary fw-bold fs-5 mb-3").text("MRP: ₹ "+a),p=$("<p>").addClass("card-text text-success fw-bolder fs-3 mb-0 pb-0").text("DP: ₹ "+s),f=$("<p>").addClass("card-text text-danger fw-bold fs-3").text("PV: "+o),g=$("<button>").attr({"data-page":"product","data-gds":t}).addClass("btn btn-primary mb-4 rounded-3 product-link").text("Read Details");return i.append(p,f),c.append(l,u,i,g),n.append(d,c),observer.observe(d[0]),g.on("click",function(){const t=$(this).data("page"),e=$(this).data("gds");urlCrawler(t,e)}),n}function s(){return $(window).width()<$(window).height()}function o(){console.log("Mobile screen detected!")}function r(){console.log("Non-mobile screen detected!"),setInterval(function(){$(".card").addClass("shadow"),$(".card-body").removeClass("shadow")},300)}function n(t,e){let a=null;return function(){clearTimeout(a),a=setTimeout(t,e)}}function d(){s()?o():r()}t(),d();const c=n(d,200);$(window).on("resize",c)};export const details=()=>{var t=retrieveData("gds");t&&$.getJSON("data/level3.json",function(e){var a=e.find(function(e){return e.gds===t});if(a){var s=$("<img>").attr("src",a.bannerImgUrl).addClass("mx-auto d-flex pb-5").css({width:"300px",height:"300px"});if(a.detailImages&&a.detailImages.length>0){var o=$("#imageD1");a.detailImages.forEach(function(t){var e=$("<img>").attr({"data-src":t,alt:"detailed img",loading:"lazy"}).addClass("p-1").css({width:"100%"});o.append(e),observer.observe(e[0])})}var r=$("#result");r.append(s)}}).fail(function(t){console.log("Error fetching JSON data:",t)})};export const storeData=(t,e)=>{localStorage.setItem(t,JSON.stringify(e))};export const retrieveData=t=>{const e=localStorage.getItem(t);return e?JSON.parse(e):null};export const removeData=t=>{localStorage.removeItem(t)};export const clearData=()=>{localStorage.clear()};export const observer=new IntersectionObserver(t=>{const e="invisible";t.forEach(t=>{const a=$(t.target),s=a.closest(".card");t.isIntersecting?(a.attr("src",a.data("src")),s.length?s.addClass("fadeIn").removeClass(e):a.addClass("fadeIn").removeClass(e)):s.length?s.removeClass("fadeIn").addClass(e):a.removeClass("fadeIn").addClass(e)})});export const searchbar=()=>{function t(t,e){return e.filter(e=>e.title.toLowerCase().includes(t.toLowerCase()))}function e(t){0===t.length||($("#productList .card").addClass("visually-hidden"),t.forEach(t=>{const e=$(`#productList .card:contains("${t.title}")`);e.removeClass("visually-hidden")}))}const a=$("#closeIcon");$.getJSON("data/level1.json",function(a){const s=a;$("#searchInput").on("input",function(){const a=$(this).val();if(""!==a.trim()){const o=t(a,s);e(o)}else $("#productList .card").removeClass("visually-hidden")})}),a.on("click",function(){$("#searchInput").val("").focus(),$("#productList .card").removeClass("visually-hidden")})};